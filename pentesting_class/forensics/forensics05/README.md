## CTF: Forensics AY25
Challenge: Matryoshda doll 

Category:  forensics

Points:

Difficulty: Intermediate

## Instructions

Matryoshka dolls are a set of wooden dolls of decreasing size placed one inside another. What's the final one? Image: [this](dolls.jpg)

Hints: 
1. Jnvg, lbh pna uvqr svyrf vafvqr svyrf? Ohg ubj qb lbh svaq gurz?
2. Znxr fher gb fhozvg gur synt nf cvpbPGS{KKKKK}


## Solution

I need to look into the image to see if i can find the flag
* Using file I found out it is a pgn file
* When opening the file it is just a wood doll but it does look a little fuzzy which could mean the bits were messed with

Hex dump 
* when doing a hex dump there is no obvious strings that would be the key
* There is some lines that talk about base_images/2_c.jpgUT which seem like a file path 

Binwalk 
* using the binwalk command I found out there another file inside of the png image

    binwalk -e dolls.jpg  

      /usr/lib/python3/dist-packages/binwalk/core/magic.py:431: SyntaxWarning: invalid escape sequence '\.'              
       self.period = re.compile("\.")   

      DECIMAL       HEXADECIMAL     DESCRIPTION                                                                          
      --------------------------------------------------------------------------------                                   
      0             0x0             PNG image, 594 x 1104, 8-bit/color RGBA, non-interlaced                              
      3226          0xC9A           TIFF image data, big-endian, offset of first image directory: 8                      
      272492        0x4286C         Zip archive data, at least v2.0 to extract, compressed size: 378950, uncompressed siz
      e: 383938, name: base_images/2_c.jpg                                                                               
      651608        0x9F158         End of Zip archive, footer length: 22     

This resulted in the creating of the directory [dolls.jpg.extrated](_dolls.jpg.extracted)

It appears I need to do it at least a few more times. 

After doing binwalk 3 times I am left with the file [flag.txt](flag.txt)



## Flag

picoCTF{4f11048e83ffc7d342a15bd2309b47de} 
 
## Mitigation

When just nesting the flag in a file multiple times it is leaving the flag up just for a scavanger hunt. To make it more than just a scavenger hunt for someone attempting to get your infromation you can encrypt the flag as well. You could encrypt the file at every step of the nesting making your info harder to both find the nested files and get the infromation.
