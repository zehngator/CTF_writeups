## CTF: Forensics AY25
Challenge: Verify

Category:  forensics

Points:

Difficulty: Introductory

## Instructions

People keep trying to trick my players with imitation flags. I want to make sure they get the real thing! I'm going to provide the SHA-256 hash and a decrypt script to help you know that my flags are legitimate.  
You can download the challenge files here:  
challenge.zip  
The same files are accessible via SSH here:  
ssh -p 62477 ctf-player@rhea.picoctf.net  
Using the password 6abf4a82. Accept the fingerprint with yes, and ls once connected to begin. Remember, in a shell, passwords are hidden!  
Checksum: b09c99c555e2b39a7e97849181e8996bc6a62501f0149c32447d8e65e205d6d2  
To decrypt the file once you've verified the hash, run ./decrypt.sh files/<file>.  

Hints:  
1. Purpxfhzf yrg lbh gryy vs n svyr vf pbzcyrgr naq sebz gur bevtvany qvfgevohgbe. Vs gur unfu qbrfa'g zngpu, vg'f n qvssrerag svyr.
2. Lbh pna perngr n FUN purpxfhz bs n svyr jvgu fun256fhz <svyr> be nyy svyrf va n qverpgbel jvgu fun256fhz <qverpgbel>/*.
3. Erzrzore lbh pna cvcr gur bhgchg bs bar pbzznaq gb nabgure jvgu |. Gel cenpgvpvat jvgu gur 'Svefg Terc' punyyratr vs lbh'er fghpx!
## Solution
I need to check the checksum of the files and see which file i need to decrypt

There are alot of files to check sum 
* to check sum them all use
    sha256sum ./*

Need to grep the reults to find the right check sum to decrypt

    sha256sum ./* | grep b09c99c555e2b39a7e97849181e8996bc6a62501f0149c32447d8e65e205d6d2
> b09c99c555e2b39a7e97849181e8996bc6a62501f0149c32447d8e65e205d6d2  ./451fd69b  

* Now i need to decrypt that file using ./decrypt

* when trying to decrypt got an error saying:  

Error: 'files/451fd69b' is not a valid file. Look inside the 'files' folder with 'ls -R'!

There was an error in the given decrypt code
* since the code was designed for doing it while sshed in the file location started from / insetead of ./ meaning I had to rewrite the part about reading the file in to the decrypter.

[Fixed code](https://gitlab.usna.edu/cyberopsmidncourses/sy421/ay-2025-fall/zehnder/-/blob/main/forensics/forensics01/home/ctf-player/drop-in/decrypt.sh)

The given result when running the code was: 

> ./decrypt.sh files/451fd69b
picoCTF{trust_but_verify_451fd69b}

## Flag
picoCTF{trust_but_verify_451fd69b}


## Mitigation
Do not publicly give out both your check sum and the decryptor that decryptes the message you wish to hide. Giving out the checksum allows people identify who you are but in combination with the decrypt attached they can get any information they give out. Sepearting the two and organizing your checksums and decryptions is the best option.
