## CTF: Forensics AY25
Challenge: Eavesdrop

Category:  forensics

Points:

Difficulty: Intermediate

## Instructions

Download this packet capture and find the flag.  
Download [packet capture](https://gitlab.usna.edu/cyberopsmidncourses/sy421/ay-2025-fall/zehnder/-/blob/main/forensics/forensics03/capture.flag.pcap)

Hints:
1. Nyy jr xabj vf gung guvf cnpxrg pncgher vapyhqrf n pung pbairefngvba naq n svyr genafsre.

## Solution
Use wireshark to read the converstion  
When going through the packet capture I found a conversation between 2 people 
* talked about how to dycrypt the file 
> openssl des3 -d -salt -in file.des3 -out file.txt -k supersecretpassword123
* need to find out how to download file.des3 

Talked about where the file was 
> Could you transfer the file to me again?   
>    Oh great. Ok, over 9002?    
* need to look at message sent to 9002

Looking at packets sent to 9002
* foundone wih a payload starting with Salted__  bingo  

Find out how to download and get the file
* export didn't work for me have to find another way
* use copy and paste 
    * tried copy and pasting hexdump and converting to ascii whcih resulted in a error

Method that worked
* copied over the file using the base 64 option into [file.h](file.h)
* Then decoded the file with 
        base64 -d file.h > [file.des3](file.des3)
* then ran the given code to find the key   

        openssl des3 -d -salt -in file.des3 -out file.txt -k supersecretpassword123

This resulted in [file.txt](file.txt)

## Flag

picoCTF{nc_73115_411_dd54ab67}

## Mitigation
Do not send the method to decrypt a file over the same set of message traffic. You could also encrypt the messages sent over with a known decryption method so someone who captured your packets can not decrypt what you were saying as easily.
