## CTF: Reverse Engineering [Fall AY25]
Challenge: weirdSnake

Category:   RE

Points:

Difficulty: Intermediate

## Instructions
I have a friend that enjoys coding and he hasn't stopped talking about a snake recently  
He left this [file](snake) on my computer and dares me to uncover a secret phrase from it. Can you assist?

Hints:
1. Qbjaybnq naq gel gb erirefr gur clguba olgrpbqr.
2. uggcf://qbpf.clguba.bet/3/yvoenel/qvf.ugzy

## Solution
The code is compiled python that appears to first make a list in these lines

0 LOAD_CONST               0 (4)                                                                                  
              2 LOAD_CONST               1 (54)                                                                    
              4 LOAD_CONST               2 (41)                                                                    
              6 LOAD_CONST               3 (0)                                                                     
              8 LOAD_CONST               4 (112)    
                ...
             76 LOAD_CONST              14 (9)
             78 LOAD_CONST              27 (78)
             80 BUILD_LIST              40
             82 STORE_NAME               0 (input_list)  
This completes line one 

Line 2 creates a string     
key_str = "j"
  2          84 LOAD_CONST              28 ('J')
             86 STORE_NAME               1 (key_str)

line 3 adds "_" to the string  
3          88 LOAD_CONST              29 ('_')  
             90 LOAD_NAME                1 (key_str)  
             92 BINARY_ADD  
             94 STORE_NAME               1 (key_str)    
Then through line six chars are added to the key_str one at a time

line 9 puts all of the letters of the string in to a list  
            120 LOAD_CONST              33 (<code object <listcomp> at 0x7ffb38066d40, file "snake.py", line 9>)  
            122 LOAD_CONST              34 ('<listcomp>')   
            124 MAKE_FUNCTION            0  
            126 LOAD_NAME                1 (key_str)  
            128 GET_ITER  
            130 CALL_FUNCTION            1  
            132 STORE_NAME               2 (key_list)  

The <listcomp> function was at the bottom 
I belevie it is:   
    key_list = [ord(char) for char in key_str]   

  9           0 BUILD_LIST               0                                                                                                                                                                                                    
              2 LOAD_FAST                0 (.0)            
        >>    4 FOR_ITER                12 (to 18)         
              6 STORE_FAST               1 (char)          
              8 LOAD_GLOBAL              0 (ord)           
             10 LOAD_FAST                1 (char)          
             12 CALL_FUNCTION            1                 
             14 LIST_APPEND              2                 
             16 JUMP_ABSOLUTE            4                 
        >>   18 RETURN_VALUE             

line 11 while loop that extends key_list by itself untill its no longer less than input_list

line 15 has a complist too:

 15           0 BUILD_LIST               0                 
              2 LOAD_FAST                0 (.0)            
        >>    4 FOR_ITER                16 (to 22)         
              6 UNPACK_SEQUENCE          2                 
              8 STORE_FAST               1 (a)             
             10 STORE_FAST               2 (b)             
             12 LOAD_FAST                1 (a)             
             14 LOAD_FAST                2 (b)             
             16 BINARY_XOR                                 
             18 LIST_APPEND              2                 
             20 JUMP_ABSOLUTE            4                 
        >>   22 RETURN_VALUE 
         
This code I believe unpacks a zip file and file that is given in line 15 and then xors each tuple then add it to a list   
The complist function run on line 15 is given a zip of both key_list and input_list.    


After doing all that I got close with 
picoCTF{N0M3]_:2X$K;~\ta7p\x1c"\x04

[first code](at1)

I think my problem was that I accidently shortend the list when I get rid of repeatting numbers so I need to not organize them and just put them in how they were.

After putting in the right list i got

picoCTF{N0t_sO_coNfus1ng_sn@ke_1a73777f}

## Flag

picoCTF{N0t_sO_coNfus1ng_sn@ke_1a73777f}

## Mitigation
To best protect yourself you should not let people access your compiled code at that level. If they need to have access you your compiled code it should be compiled in machine language so it is much harder to decypher. Or have the byte code striped so it does not have info such as variable names.
