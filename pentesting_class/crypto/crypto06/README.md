## CTF: Cryptographic Analysis Fall AY25
Challenge: Mind your Ps and Qs 

Category: crypto

Points:

Difficulty:  Intermediate

## Instructions

In RSA, a small e value can be problematic, but what about N? Can you decrypt this? values

Hint:  
Ovgf ner rkcrafvir, V hfrq bayl n yvggyr ovg bire 100 gb fnir zbarl

## Solution

The [values](values) that I revieced for this crypto were

Decrypt my super sick RSA:  
c: 861270243527190895777142537838333832920579264010533029282104230006461420086153423  
n: 1311097532562595991877980619849724606784164430105441327897358800116889057763413423  
e: 65537 

I need to get p and q from n in order to break the RSA key

The instructions said the n was small so I will try to factor it using a website called

> [website](http://magma.maths.usyd.edu.au/calc/)

This website did not give me an awnser so I tried using a factorization code that was unable to factor such big numbers.
> [factor.c](factor.c) [factor.h](factor.h) [factorize.h](factorize.h)

So I used this website
> [alpertron](https://www.alpertron.com.ar/ECM.HTM)

This gave me the p and q of

        1955 175890 537890 492055 221842 734816 092141  
&nbsp;  

        670577 792467 509699 665091 201633 524389 157003 

Now that I have my p and q I have to decrypt the message

I know the cipher text is equal to   

plaintext^e % n 

* The next step is to find d  
In order to do this I found a [code on stack exchange](dfinder.py)  
the resulting d is: 

        617568409146090578898534594729099571408614902492054272595378412950175520568389327  

This code also did the function to gain the plaintext by doing the function:  
ciphertext^d % n 

Giving:

        13016382529449106065927291425342535437996222135352905256639573959002849415739773

Next I have to convert the number into bytes:

I spent 30 min trying to figure out how to stop int too big to convert, found out I just had to change the first number in to_bytes()

The [code](get_pt.py) I used to convert it was:
        pt.to_bytes(106,"big")

The output was:
        picoCTF{sma11_N_n0_g0od_13686679}


## Flag

picoCTF{sma11_N_n0_g0od_13686679}

## Mitigation

In order to stop this from happening you need to make sure that your n is big enouogh that someone can not factor it.
